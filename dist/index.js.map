{"version":3,"file":"index.js","sources":["../src/event-dispatcher.js","../src/browserbase.js"],"sourcesContent":["const slice = Array.prototype.slice;\n\n/**\n * Simple event dispatcher\n */\nexport default class EventDispatcher {\n\n  constructor() {\n    // Define a non-enumerable \"private\" property to hold all event listeners\n    Object.defineProperty(this, '_events', { configurable: true, writable: true, value: {} });\n  }\n\n  /**\n   * Adds an event listener\n   */\n  on(type, listener) {\n    this._events[type] = getEventListeners(this, type).concat([listener]);\n    return this;\n  }\n\n  /**\n   * Adds an event listener to be triggered only once\n   */\n  once(type, listener) {\n    this.on(type, function wrap() {\n      this.off(type, wrap);\n      listener.apply(this, arguments);\n    });\n    return this;\n  }\n\n  /**\n   * Removes a previously added event listener\n   */\n  off(type, listener) {\n    this._events[type] = getEventListeners(this, type).filter(function(l) {\n      return l !== listener;\n    });\n    return this;\n  }\n\n  /**\n   * Dispatches an event calling all listeners with the given args (minus type).\n   */\n  dispatchEvent(type /*[, args]*/) {\n    var args = slice.call(arguments, 1);\n    getEventListeners(this, type).forEach(function(listener) {\n      listener.apply(this, args);\n    }, this);\n    return this;\n  }\n\n  /**\n   * Dispatches an event but stops on the first listener to return false. Returns true if no listeners cancel the\n   * action. Use for \"cancelable\" actions to check if they can be performed.\n   */\n  dispatchCancelableEvent(type /*[, args]*/) {\n    var args = slice.call(arguments, 1);\n    return getEventListeners(this, type).every(function(listener) {\n      return listener.apply(this, args) !== false;\n    }, this);\n  }\n\n  removeAllEvents() {\n    this._events = {};\n  }\n}\n\n\n/**\n * Get the listeners for the given object by the given event type.\n */\nfunction getEventListeners(obj, type) {\n  var listeners = obj._events[type];\n  if (!listeners) {\n    obj._events[type] = listeners = [];\n  }\n  return listeners;\n}\n","import EventDispatcher from './event-dispatcher';\nconst maxString = String.fromCharCode(65535);\nconst localStorage = window.localStorage;\n\n\n/**\n * A nice promise-based syntax on indexedDB also providing events when open, closed, and whenever data is changed.\n * Dispatches the change events even when the change did not originate in this browser tab.\n *\n * Versioning is simplified. You provide a string of new indexes for each new version, with the first being the primary\n * key. For primary keys, use a \"++\" prefix to indicate auto-increment, leave it empty if the key isn't part of the\n * object. For indexes, use a \"-\" index to delete a defined index, use \"&\" to indicate a unique index, use \"*\" for a\n * multiEntry index, and use \"[field + anotherField]\" for compound indexes. Examples:\n *\n * // Initial version, should remain the same with updates\n * db.version(1, {\n *   friends: 'fullName, age'\n * });\n *\n * // Next version, we don't add any indexes, but we want to run our own update code to prepopulate the database\n * db.version(2, {}, function(oldVersion, transaction) {\n *   // prepopulate with some initial data\n *   transaction.objectStore('friends').put({ fullName: 'Tom' });\n * });\n *\n * // Remove the age index and add one for birthdate, add another object store with an auto-incrementing primary key\n * // that isn't part of the object, and a multiEntry index on the labels array.\n * db.version(3, {\n *   friends: 'birthdate, -age, [lastName + firstName]',\n *   events: '++, date, *labels'\n * });\n *\n *\n * After the database is opened, a property will be added to the database instance for each object store in the\n * database. This is how you will work with the data in the database. For e.g.\n *\n * db.version(1, { foo: 'id' });\n *\n * // Will be triggered once for any add, put, or delete done in any browser tab. The object will be null when it was\n * // deleted, so use the key when object is null.\n * db.on('change', (object, key) => {\n *   console.log('Object with key', key, 'was', object === null ? 'deleted' : 'saved');\n * });\n *\n * db.open().then(() => {\n *   db.foo.put({ id: 'bar' }).then(() => {\n *     console.log('An object was saved to the database.');\n *   });\n * }, err => {\n *   console.warn('There was an error opening the database:', err);\n * });\n */\nexport default class Browserbase extends EventDispatcher {\n\n  /**\n   * Deletes a database by name.\n   * @return {Promise}\n   */\n  static deleteDatabase(name) {\n    return requestToPromise(window.indexedDB.deleteDatabase(name));\n  }\n\n  /**\n   * Creates a new indexeddb database with the given name.\n   */\n  constructor(name) {\n    super();\n    this.name = name;\n    this.db = null;\n    this.current = null;\n    this._versionMap = {};\n    this._versionHandlers = {};\n    this._onStorage = null;\n  }\n\n  /**\n   * Defines a version for the database. Additional versions may be added, but existing version should not be changed.\n   * @param  {Number} version           The version number\n   * @param  {Object} stores            An object with store name as the key and a comma-delimited string of indexes\n   * @param  {Function} upgradeFunction An optional function that will be called when upgrading, used for data updates\n   * @return {Browserbase}                A reference to itself\n   */\n  version(version, stores, upgradeFunction) {\n    this._versionMap[version] = stores;\n    if (upgradeFunction) {\n      this._versionHandlers[version] = upgradeFunction;\n    }\n    return this;\n  }\n\n  /**\n   * Whether this database is open or closed.\n   * @return {Boolean}\n   */\n  isOpen() {\n    return Boolean(this.db);\n  }\n\n  /**\n   * Open a database, call this after defining versions.\n   * @return {Promise}\n   */\n  open() {\n    if (!Object.keys(this._versionMap).length) {\n      return Promise.reject(new Error('Must declare at least a version 1 schema for Browserbase'));\n    }\n    let version = Object.keys(this._versionMap).map(key => parseInt(key)).sort((a, b) => a - b).pop();\n    return new Promise((resolve, reject) => {\n      let request = window.indexedDB.open(this.name, version);\n      request.onsuccess = successHandler(resolve);\n      request.onerror = errorHandler(reject);\n      request.onupgradeneeded = event => {\n        this.db = request.result;\n        this.db.onerror = errorHandler(reject);\n        this.db.onabort = errorHandler(() => reject(new Error('Abort')));\n        let oldVersion = event.oldVersion > Math.pow(2, 62) ? 0 : event.oldVersion; // Safari 8 fix.\n        upgrade(oldVersion, request.transaction, this.db, this._versionMap, this._versionHandlers);\n      };\n    }).then(db => {\n      this.db = db;\n      this.dispatchEvent('open');\n      onOpen(this);\n    });\n  }\n\n  /**\n   * Closes the databse.\n   */\n  close() {\n    if (!this.db) return;\n    this.db.close();\n    onClose(this);\n  }\n\n  /**\n   * Starts a multi-store transaction. All store methods after calling this will be part of this transaction until\n   * the next tick or until calling commitTransaction().\n   * @param  {Array} storeNames  Array of all the store names which will be used within this transaction\n   * @param  {String} mode       The mode, defaults to readwrite unlike the indexedDB API\n   * @return {Promise}           A promise which is resolved once the transaction is complete\n   */\n  start(storeNames, mode = 'readwrite') {\n    if (!storeNames) storeNames = this.db.objectStoreNames;\n    let trans = this.current = this.db.transaction(safariMultiStoreFix(storeNames), mode);\n    return this.current.promise = requestToPromise(this.current).then(result => {\n      if (this.current === trans) this.current = null;\n      return result;\n    }, err => {\n      if (this.current === trans) this.current = null;\n      return Promise.reject(err);\n    });\n  }\n\n  /**\n   * Finishes a started transaction so that other transactions may be run. This is not needed for a transaction to run,\n   * but it allows other transactions to be run in this thread. It ought to be called to avoid conflicts with other\n   * code elsewhere.\n   * @return {Promise} The same promise returned by start() which will resolve once the transaction is done.\n   */\n  commit() {\n    if (!this.current) throw new Error('There is no current transaction to commit.');\n    let promise = this.current.promise;\n    this.current = null;\n    return promise;\n  }\n\n  /**\n   * Dispatches a change event when an object is being added, saved, or deleted. When deleted, the object will be null.\n   * @param {ObjectStore} store  The object store this object is stored in\n   * @param {Object}      obj    The object being modified or null if the object is deleted\n   * @param {mixed}       key    The key of the object being changed or deleted\n   * @param {String}      from   The source of this event, whether it was from the 'local' window or a 'remote' window\n   */\n  dispatchChange(store, obj, key, from = 'local') {\n    this.dispatchEvent('change', store.name, obj, key, from);\n    store.dispatchEvent('change', obj, key, from);\n    if (from === 'local') {\n      let itemKey = `browserbase/${this.name}/${store.name}`;\n      localStorage.setItem(itemKey, key);\n      localStorage.removeItem(itemKey);\n    }\n  }\n\n}\n\n\n/**\n * An abstraction on object stores, allowing to more easily work with them without needing to always explicitly create a\n * transaction first. Also helps with ranges and indexes and promises.\n */\nclass ObjectStore extends EventDispatcher {\n\n  constructor(db, name, keyPath) {\n    super();\n    this.db = db;\n    this.name = name;\n    this.keyPath = keyPath;\n  }\n\n  _transStore(mode, index) {\n    let trans = this.db.current || this.db.db.transaction(this.name, mode);\n    return trans.objectStore(this.name);\n  }\n\n  /**\n   * Get an object from the store by its primary key\n   * @param  {mixed} id The key of the object being retreived\n   * @return {Promise}  Resolves with the object being retreived\n   */\n  get(key) {\n    return requestToPromise(this._transStore('readonly').get(key));\n  }\n\n  /**\n   * Get all objects in this object store. To get only a range, use where()\n   * @return {Promise} Resolves with an array of objects\n   */\n  getAll() {\n    return requestToPromise(this._transStore('readonly').getAll());\n  }\n\n  /**\n   * Gets the count of all objects in this store\n   * @return {Promise} Resolves with a number\n   */\n  count() {\n    return requestToPromise(this._transStore('readonly').count());\n  }\n\n  /**\n   * Adds an object to the store. If an object with the given key already exists, it will not overwrite it.\n   * @param {Object} obj The object you want to add to the store\n   * @param {mixed} key Optional, the key of the object when it is not part of the object fields\n   * @return {Promise}\n   */\n  add(obj, key) {\n    let store = this._transStore('readwrite');\n    return requestToPromise(store.add(obj, key), store.transaction).then(key => {\n      this.db.dispatchChange(this, obj, key);\n      return key;\n    });\n  }\n\n  /**\n   * Adds an array of objects to the store in once transaction. You can also call startTransaction and use add().\n   * @param {Array} array The array of objects you want to add to the store\n   * @return {Promise}\n   */\n  bulkAdd(array) {\n    let store = this._transStore('readwrite');\n    return Promise.all(array.map(obj => {\n      return requestToPromise(store.add(obj), store.transaction).then(key => {\n        this.db.dispatchChange(this, obj, key);\n      });\n    }));\n  }\n\n  /**\n   * Saves an object to the store. If an object with the given key already exists, it will overwrite it.\n   * @param {Object} obj The object you want to add to the store\n   * @param {mixed} key Optional, the key of the object when it is not part of the object fields\n   * @return {Promise}\n   */\n  put(obj, key) {\n    let store = this._transStore('readwrite');\n    return requestToPromise(store.put(obj, key), store.transaction).then(key => {\n      this.db.dispatchChange(this, obj, key);\n      return key;\n    });\n  }\n\n  /**\n   * Saves an array of objects to the store in once transaction. You can also call startTransaction and use put().\n   * @param {Array} array The array of objects you want to save to the store\n   * @return {Promise}\n   */\n  bulkPut(array) {\n    let store = this._transStore('readwrite');\n    return Promise.all(array.map(obj => {\n      return requestToPromise(store.put(obj), store.transaction).then(key => {\n        this.db.dispatchChange(this, obj, key);\n      });\n    }));\n  }\n\n  /**\n   * Deletes an object from the store.\n   * @param {mixed} key The key of the object to delete.\n   * @return {Promise}\n   */\n  delete(key) {\n    let store = this._transStore('readwrite');\n    return requestToPromise(store.delete(key), store.transaction).then(() => {\n      this.db.dispatchChange(this, null, key);\n    });\n  }\n\n  /**\n   * Deletes an object from the store.\n   * @param {mixed} key The key of the object to delete.\n   * @return {Promise}\n   */\n  deleteAll() {\n    return this.where().deleteAll();\n  }\n\n  /**\n   * Use to get a subset of items from the store by id or index. Returns a Where object to allow setting the range and\n   * limit.\n   * @param  {String} index The key or index that will be used to retreive the range of objects\n   * @return {Where}        A Where instance associated with this object store\n   */\n  where(index = '') {\n    index = index.replace(/\\s/g, '');\n    return new Where(this, index === this.keyPath ? '' : index);\n  }\n}\n\n\n/**\n * Helps with a ranged getAll or openCursor by helping to create the range and providing a nicer API with returning a\n * promise or iterating through with a callback.\n */\nclass Where {\n  constructor(store, index) {\n    this.store = store;\n    this.index = index;\n    this._upper = undefined;\n    this._lower = undefined;\n    this._upperOpen = false;\n    this._lowerOpen = false;\n    this._value = undefined;\n    this._limit = undefined;\n    this._direction = 'next';\n  }\n\n  /**\n   * Set greater than the value provided.\n   * @param  {mixed} value The lower bound\n   * @return {Where}       Reference to this\n   */\n  startsAfter(value) {\n    this._lower = value;\n    this._lowerOpen = true;\n    return this;\n  }\n\n  /**\n   * Set greater than or equal to the value provided.\n   * @param  {mixed} value The lower bound\n   * @return {Where}       Reference to this\n   */\n  startsAt(value) {\n    this._lower = value;\n    this._lowerOpen = false;\n    return this;\n  }\n\n  /**\n   * Set less than the value provided.\n   * @param  {mixed} value The upper bound\n   * @return {Where}       Reference to this\n   */\n  endsBefore(value) {\n    this._upper = value;\n    this._upperOpen = true;\n    return this;\n  }\n\n  /**\n   * Set less than or equal to the value provided.\n   * @param  {mixed} value The upper bound\n   * @return {Where}       Reference to this\n   */\n  endsAt(value) {\n    this._upper = value;\n    this._upperOpen = false;\n    return this;\n  }\n\n  /**\n   * Set the exact match, no range.\n   * @param  {mixed} value The value that needs matching on\n   * @return {Where}       Reference to this\n   */\n  equals(value) {\n    this._value = value;\n    return this;\n  }\n\n  /**\n   * Sets the upper and lower bounds to match any string starting with this prefix.\n   * @param  {String} prefix The string prefix\n   * @return {Where}         Reference to this\n   */\n  startsWith(prefix) {\n    return this.startsAt(prefix).endsAt(prefix + maxString);\n  }\n\n  /**\n   * Limit the return results to the given count.\n   * @param  {Number} count The max number of objects to return\n   * @return {Where}        Reference to this\n   */\n  limit(count) {\n    this._limit = count;\n    return this;\n  }\n\n  /**\n   * Reverses the direction a cursor will get things.\n   * @return {Where} Reference to this\n   */\n  reverse() {\n    this._direction = 'prev';\n    return this;\n  }\n\n  /**\n   * Converts this Where to its IDBKeyRange equivalent.\n   * @return {IDBKeyRange} The range this Where represents\n   */\n  toRange() {\n    if (this._upper !== undefined && this._lower !== undefined) {\n      return IDBKeyRange.bound(this._lower, this._upper, this._lowerOpen, this._upperOpen);\n    } else if (this._upper !== undefined) {\n      return IDBKeyRange.upperBound(this._upper, this._upperOpen);\n    } else if (this._lower !== undefined) {\n      return IDBKeyRange.lowerBound(this._lower, this._lowerOpen);\n    } else if (this._value !== undefined) {\n      return IDBKeyRange.only(this._value);\n    }\n  }\n\n  /**\n   * Get all the objects matching the range limited by the limit.\n   * @return {Promise} Resolves with an array of objects\n   */\n  getAll() {\n    let range = this.toRange();\n    // Handle reverse with getAll and get\n    if (this._direction === 'prev') {\n      let results = [];\n      if (this._limit <= 0) return Promise.resolve(results);\n      return this.forEach(obj => results.push(obj)).then(() => results);\n    }\n\n    let store = this.store._transStore('readonly');\n    let source = this.index ? store.index(this.index) : store;\n    return requestToPromise(source.getAll(range, this._limit));\n  }\n\n  /**\n   * Get all the keys matching the range limited by the limit.\n   * @return {Promise} Resolves with an array of objects\n   */\n  getAllKeys() {\n    let range = this.toRange();\n    // Handle reverse with getAll and get\n    if (this._direction === 'prev') {\n      let results = [];\n      if (this._limit <= 0) return Promise.resolve(results);\n      return this.cursor(cursor => results.push(cursor.key), 'readonly', true).then(() => results);\n    }\n\n    let store = this.store._transStore('readonly');\n    let source = this.index ? store.index(this.index) : store;\n    return requestToPromise(source.getAllKeys(range, this._limit));\n  }\n\n  /**\n   * Gets a single object, the first one matching the criteria\n   * @return {Promise} Resolves with an object or undefined if none was found\n   */\n  get() {\n    return this.limit(1).getAll().then(result => result[0]);\n  }\n\n  /**\n   * Gets a single key, the first one matching the criteria\n   * @return {Promise} Resolves with an object or undefined if none was found\n   */\n  getKey() {\n    // Allow reverse() to be used by going through the getAllKeys method\n    return this.limit(1).getAllKeys().then(result => result[0]);\n  }\n\n  /**\n   * Gets the count of the objects matching the criteria\n   * @return {Promise} Resolves with a number\n   */\n  count() {\n    let range = this.toRange();\n    let store = this.store._transStore('readonly');\n    let source = this.index ? store.index(this.index) : store;\n    return requestToPromise(source.count(range));\n  }\n\n  /**\n   * Deletes all the objects within this range.\n   * @return {Promise} Resolves without result when finished\n   */\n  deleteAll() {\n    // Uses a cursor to delete so that each item can get a change event dispatched for it\n    return this.map((object, cursor, trans) => {\n      let key = cursor.primaryKey;\n      return requestToPromise(cursor.delete(), trans).then(() => {\n        this.store.db.dispatchChange(this.store, null, key);\n      });\n    }, 'readwrite').then(promises => Promise.all(promises)).then(() => {});\n  }\n\n  /**\n   * Uses a cursor to efficiently iterate over the objects matching the range calling the iterator for each one.\n   * @param  {Function} iterator A function which will be called for each object with the (object, cursor) signature\n   * @return {Promise}           Resolves without result when the cursor has finished\n   */\n  cursor(iterator, mode = 'readonly', keyCursor = false) {\n    return new Promise((resolve, reject) => {\n      let range = this.toRange();\n      let store = this.store._transStore(mode);\n      let source = this.index ? store.index(this.index) : store;\n      let method = keyCursor ? 'openKeyCursor' : 'openCursor'\n      let request = source[method](range, this._direction);\n      let count = 0;\n      request.onsuccess = event => {\n        var cursor = event.target.result;\n        if (cursor) {\n          let result = iterator(cursor, store.transaction);\n          if (this._limit !== undefined && ++count >= this._limit) result = false;\n          if (result !== false) cursor.continue();\n          else resolve();\n        } else {\n          resolve();\n        }\n      };\n      request.onerror = errorHandler(reject);\n    });\n  }\n\n  /**\n   * Updates objects using a cursor to update many objects at once matching the range.\n   * @param  {Function} iterator A function which will be called for each object and which should return the new value\n   * for the object, undefined if no changes should be made, or null if the object should be deleted.\n   * @return {Promise}           Resolves without result when finished\n   */\n  update(iterator) {\n    return this.map((object, cursor, trans) => {\n      let key = cursor.primaryKey;\n      let newValue = iterator(object, cursor);\n      if (newValue === null) {\n        return requestToPromise(cursor.delete()).then(() => {\n          this.store.db.dispatchChange(this.store, null, key);\n        });\n      } else if (newValue !== undefined) {\n        return requestToPromise(cursor.update(newValue), trans).then(() => {\n          this.store.db.dispatchChange(this.store, newValue, key);\n        });\n      } else {\n        return undefined;\n      }\n    }, 'readwrite').then(promises => Promise.all(promises)).then(() => {});\n  }\n\n  /**\n   * Uses a cursor to efficiently iterate over the objects matching the range calling the iterator for each one.\n   * @param  {Function} iterator A function which will be called for each object with the (object, cursor) signature\n   * @return {Promise}           Resolves without result when the cursor has finished\n   */\n  forEach(iterator, mode = 'readonly') {\n    return this.cursor((cursor, trans) => {\n      iterator(cursor.value, cursor, trans);\n    }, mode);\n  }\n\n  /**\n   * Uses a cursor to efficiently iterate over the objects matching the range calling the iterator for each one.\n   * @param  {Function} iterator A function which will be called for each object with the (object, cursor) signature\n   * @return {Promise}           Resolves with an array which is the return result of each iteration\n   */\n  map(iterator, mode = 'readonly') {\n    let results = [];\n    return this.forEach((object, cursor, trans) => {\n      results.push(iterator(object, cursor, trans));\n    }, mode).then(() => results);\n  }\n}\n\n\n\nfunction requestToPromise(request, transaction) {\n  return new Promise((resolve, reject) => {\n    if (transaction) {\n      if (!transaction.promise) transaction.promise = requestToPromise(transaction);\n      transaction.promise = transaction.promise.then(() => resolve(request.result), err => {\n        reject(request.error || err);\n        return Promise.reject(err);\n      });\n    } else if (request.onsuccess === null) {\n      request.onsuccess = successHandler(resolve);\n    }\n    if (request.oncomplete === null) request.oncomplete = successHandler(resolve);\n    if (request.onerror === null) request.onerror = errorHandler(reject);\n    if (request.onabort === null) request.onabort = () => reject(new Error('Abort'));\n  });\n}\n\nfunction successHandler(resolve) {\n  return event => resolve(event.target.result);\n}\n\nfunction errorHandler(reject) {\n  return event => reject(event.target.error);\n}\n\nfunction safariMultiStoreFix(storeNames) {\n  return storeNames.length === 1 ? storeNames[0] : storeNames;\n}\n\n\nfunction upgrade(oldVersion, transaction, db, versionMap, versionHandlers) {\n  let versions = Object.keys(versionMap).map(key => parseInt(key)).sort((a, b) => a - b);\n  versions.forEach(version => {\n    if (oldVersion < version) {\n      let stores = versionMap[version];\n      Object.keys(stores).forEach(name => {\n        let value = stores[name];\n        let indexes = value && value.split(/\\s*,\\s*/);\n        let store;\n\n        if (value === null) {\n          db.deleteObjectStore(name);\n          return;\n        }\n\n        if (db.objectStoreNames.contains(name)) {\n          store = transaction.objectStore(name);\n        } else {\n          let keyPath = indexes.shift().replace(/\\s/g, '');\n          let storeOptions = {};\n          if (keyPath.slice(0, 2) === '++') {\n            keyPath = keyPath.replace('++', '');\n            storeOptions.autoIncrement = true;\n          } else if (keyPath[0] === '[') {\n            keyPath = keyPath.replace(/^\\[|\\]$/g, '').split(/\\+/);\n          }\n          if (keyPath) storeOptions.keyPath = keyPath;\n          store = db.createObjectStore(name, storeOptions);\n        }\n\n        indexes.forEach(name => {\n          if (!name) return;\n          if (name[0] === '-') return store.deleteIndex(name.replace(/^-[&*]?/, ''));\n\n          let options = {};\n\n          name = name.replace(/\\s/g, '');\n          if (name[0] === '&') {\n            name = name.slice(1);\n            options.unique = true;\n          } else if (name[0] === '*') {\n            name = name.slice(1);\n            options.multiEntry = true;\n          }\n          let keyPath = name[0] === '[' ? name.replace(/^\\[|\\]$/g, '').split(/\\+/) : name;\n          store.createIndex(name, keyPath, options);\n        });\n      });\n\n      let handler = versionHandlers[version];\n      if (handler) handler(oldVersion, transaction);\n    }\n  })\n}\n\n\nfunction onOpen(browserbase) {\n  // Store keyPath's for each store\n  let keyPaths = {};\n  let versions = Object.keys(browserbase._versionMap).map(key => parseInt(key)).sort((a, b) => a - b);\n  versions.forEach(version => {\n    let stores = browserbase._versionMap[version];\n    Object.keys(stores).forEach(name => {\n      if (keyPaths[name] || !stores[name]) return;\n      let indexes = stores[name].split(/\\s*,\\s*/);\n      keyPaths[name] = indexes[0].replace(/^\\+\\+/, '');\n    });\n  });\n\n  let db = browserbase.db;\n\n  db.onversionchange = event => {\n    if (browserbase.dispatchCancelableEvent('versionchange')) {\n      if (event.newVersion > 0) {\n        console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`);\n      } else {\n        console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`);\n      }\n      browserbase.close();\n    }\n  };\n  db.onblocked = event => {\n    if (browserbase.dispatchCancelableEvent('blocked')) {\n      if (!event.newVersion || event.newVersion < event.oldVersion) {\n        console.warn(`Browserbase.delete('${browserbase.name}') was blocked`);\n      } else {\n        console.warn(`Upgrade '${browserbase.name}' blocked by other connection holding version ${event.oldVersion}`);\n      }\n    }\n  };\n  db.onclose = () => onClose(browserbase);\n  db.onerror = event => browserbase.dispatchEvent('error', event.target.error);\n  const prefix = `browserbase/${browserbase.name}/`;\n  browserbase._onStorage = event => {\n    if (event.storageArea !== localStorage) return;\n    if (event.newValue === null || event.newValue === '') return;\n    if (event.key.slice(0, prefix.length) !== prefix) return;\n    try {\n      let storeName = event.key.replace(prefix, '');\n      let key = event.newValue;\n      let store = browserbase[storeName];\n      if (store) {\n        store.get(key).then((object = null) => {\n          browserbase.dispatchChange(store, object, key, 'remote');\n        });\n      } else {\n        console.warn(`A change event came from another tab for store \"${storeName}\", but no such store exists.`);\n      }\n    } catch (err) {\n      console.warn('Error parsing object change from browserbase:', err);\n    }\n  };\n\n  window.addEventListener('storage', browserbase._onStorage);\n\n  let names = db.objectStoreNames;\n  for (let i = 0; i < names.length; i++) {\n    let name = names[i];\n    browserbase[name] = new ObjectStore(browserbase, name, keyPaths[name]);\n  }\n}\n\n\nfunction onClose(browserbase) {\n  window.removeEventListener('storage', browserbase._onStorage);\n  browserbase.db = null;\n  browserbase.dispatchEvent('close');\n}\n"],"names":["const","super","version","let","this"],"mappings":"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"}